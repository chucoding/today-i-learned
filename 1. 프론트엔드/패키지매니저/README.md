# 패키지 매니저
프로젝트의 종속성을 관리하는 도구

## npm
2010년에 등장한 Node.js의 기본 패키지 매니저
```shell
npm install <package-name>
```

### 장점
- **광범위한 사용**: 가장 널리 사용되는 패키지 매니저로, 풍부한 자료와 커뮤니티 지원.
- **npm 레지스트리**: 방대한 패키지 레지스트리를 통해 다양한 라이브러리와 도구를 쉽게 설치 가능.

### 단점
- **속도**: 초기 설치 속도가 느릴 수 있음.
- **디스크 공간**: 중복된 패키지 설치로 인해 디스크 공간을 많이 차지할 수 있음

> v7 이후 arborist 도입하며 워크스페이스 등 내부 구조가 크게 바뀌며 성능, 안정성이 좋아졌지만 여전히 pnpm이 빠름

## Yarn Classic(1.x)
Facebook이 2016년에 개발하여 공개한 패키지 매니저로 NPM의 속도를 해결하기 위해 만들어짐 (병렬처리 및 로컬캐시 최초 고안)

```shell
yarn add <package-name>
```
### 장점
- **빠른 속도**: 병렬 설치와 캐싱을 통해 빠른 설치 속도 제공.
- **워크스페이스**: 모노레포 지원을 통해 여러 패키지를 하나의 리포지토리에서 관리 가능.

### 단점
- **추가 설치 필요**: Node.js와 함께 기본적으로 설치되지 않으며, 별도로 설치해야 함.
- **커뮤니티**: npm에 비해 상대적으로 작은 커뮤니티.
- 지금은 메인터넌스 모드로 새 기능은 대부분 Berry(2.x+)에 집중

## Yarn Berry

### 장점
PnP(Plug'n'Play) 모드 사용시 `node_modules` 대신 `.yarn/cache`에 ZipFS 방식으로 패키지를 압축하여 저장하기에 패키지 설치 시간을 줄일 수 있음.

### 단점
- 일부 도구(경로를 직접 더미 탐색하는 툴)와 호환성이 떨어질 수 있어 설정 필요.
  - pnpm은 node_modules를 유지하면서도 CAS + 링크로 속도/용량을 잡고 호환성도 보장
- yarn에서 설정 미스(예: PnP, zero-install, nodeLinker 등)로 이슈가 나는 경우가 발생할 수 있어 npm이 더 수월할 수도 있음
- 작업한 뒤 커밋하면 `.git/objects` 내에 변경된 파일이 zlib으로 압축되어 영구히 기록으로 남음
  - 커밋이 많은 경우 git 체크아웃, 브랜칭 속도에 영향

## pnpm

### 저장 방식
하드링크/심링크 방식으로 저장
- 패키지 설치시 콘텐츠 주소 저장소(CAS: Content-Addressable Store)에 저장
  - 레지스트리/프로젝트가 달라도 스토어에 딱 한번만 저장
  - ex. `~/.local/share/pnpm/store/v3/<sha512>/`
- 전역 스토어 → 가상스토어(`node_modules/.pnpm/…`): 하드링크(가능 시, 아니면 자동 폴백: reflink/copy)
  - 복사 없이 실제 디스크 블록을 공유
  - 가상스토어를 사용하기 때문에 격리된 구조를 유지함
  - `package-import-method=auto|hardlink|reflink|copy` 로 고정 가능
- 프로젝트 node_modules/<name> → .pnpm: 심링크/정션
로 연결하여 복사 없이 설치(속도↑, 용량↓).

### 장점

- **디스크 절약**: 하드링크/심링크 방식으로 중복된 패키지 설치를 방지하여 Yarn, npm 대비 디스크 공간 압도적으로 절약
- **빠른 속도**: 병렬 설치와 효율적인 캐싱을 통해 빠른 설치 속도 제공.
- **모노레포 지원**: Yarn Berry에 비해 워크스페이스 기능이 간단하여 여러 대규모 팀에서 pnpm 도입 사례가 증가

### 단점
- **추가 설치 필요**: Node.js와 함께 기본적으로 설치되지 않으며, 별도로 설치해야 함.

## Bun
### 장점
- **통합된 도구**: 번들러, 패키지 매니저, 테스트 러너가 통합되어 있어 별도의 설정 없이 사용 가능.
- **빠른 속도**: Zig 언어로 작성되어 매우 빠른 설치 및 실행 속도 제공.
- **최신 기능 지원**: 최신 JavaScript 및 TypeScript 기능을 지원.

### 단점
- **호환성 문제**: 일부 기존 도구나 라이브러리와의 호환성 문제가 있을 수 있음.

## 📊 비교 요약
| 항목        | npm         | Yarn (Classic 1.x) | Yarn Berry (2.x~) | pnpm             |
| --------- | ----------- | ------------------ | ----------------- | ---------------- |
| 속도        | 중간(최근 개선)   | 중간                 | **빠름(특히 PnP)**    | **빠름(전반적으로 우수)** |
| 디스크 효율    | 낮음~중간       | 낮음                 | 중간(ZipFS)         | **최고(CAS+링크)**   |
| 워크스페이스 지원 | **지원(v7+)** | 지원                 | 지원                | 지원               |
| 설정 난이도    | 낮음          | 낮음                 | **높음(PnP/플러그인)**  | 낮음               |
| 모노레포 친화성  | 보통          | 보통                 | 좋음                | **매우 좋음**        |

# 참고자료
| TITLE | URL |
|---|---|
| 성능 벤치마크 사이트 | https://pnpm.io/benchmarks |
| npm vs yarn | https://velog.io/@jma1020/npm-yarn-%EB%AC%B4%EC%97%87%EC%9D%B4%EA%B3%A0-%EC%96%B4%EB%96%A4-%EC%B0%A8%EC%9D%B4 |
| yarn vs pnpm | https://engineering.ab180.co/stories/yarn-to-pnpm |