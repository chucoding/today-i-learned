# Postgres
ëŒ€í‘œì ì¸ NoSQLê¸°ë°˜ ë¬´ë£Œ ë°ì´í„°ë² ì´ìŠ¤
- ì„¤ì •íŒŒì¼ : /etc/postgres
- ì €ì¥ì†Œ : /var/lib/postgres

# ubuntu ì„¤ì¹˜ ë°©ë²•
1. ì„¤ì¹˜ëœ íŒ¨í‚¤ì§€ê°€ ìˆëŠ”ì§€ í™•ì¸(ì´ë¯¸ ì„¤ì¹˜ë˜ì–´ìˆëŠ”ë° ë‹¤ì‹œ ì„¤ì¹˜í•˜ëŠ”ê²ƒì„ ë°©ì§€)
```
pg_lsclusters
```

2. ìµœì‹ ë²„ì „ì„ ì„¤ì¹˜í•˜ê¸° ìœ„í•œ apt ì €ì¥ì†Œ ì¶”ê°€
```
sudo sh -c 'echo "deb http://apt.postgresql.org/pub/repos/apt $(lsb_release -cs)-pgdg main" > /etc/apt/sources.list.d/pgdg.list'
```

3. PostgreSQL ì €ì¥ì†Œ GPG í‚¤ ì¶”ê°€
```
wget --quiet -O - https://www.postgresql.org/media/keys/ACCC4CF8.asc | sudo apt-key add -
```

4. íŒ¨í‚¤ì§€ ëª©ë¡ ì¬ì—…ë°ì´íŠ¸
```
sudo apt update
```

5. postgres ì„¤ì¹˜
```
sudo apt install postgresql-13
```

6. ì´ˆê¸°í™” ë° í´ëŸ¬ìŠ¤í„° ìƒì„±
```
sudo pg_createcluster 13 main --start
```

7. postgres ì¬ì‹œì‘
```
sudo service postgresql restart
```

8. postgres ì ‘ì†
sudo -u postgres psql

9. ë°ì´í„°ë² ì´ìŠ¤ ìƒì„±
```
CREATE DATABASE mydb;
```

10. ë¹„ë°€ë²ˆí˜¸ ë³€ê²½
```
ALTER USER postgres WITH PASSWORD 'ìƒˆë¡œìš´_ë¹„ë°€ë²ˆí˜¸';
```

# centos ì„¤ì¹˜ ë°©ë²•

1. ì„¤ì¹˜ëœ íŒ¨í‚¤ì§€ê°€ ìˆëŠ”ì§€ í™•ì¸(ì´ë¯¸ ì„¤ì¹˜ë˜ì–´ìˆëŠ”ë° ë‹¤ì‹œ ì„¤ì¹˜í•˜ëŠ”ê²ƒì„ ë°©ì§€)
```
yum list installed | grep postgresql
```

2. ì„¤ì¹˜ ê°€ëŠ¥í•œ postgresql íŒ¨í‚¤ì§€ ë²„ì „ í™•ì¸
```shell 
yum list postgresql*
```
ğŸ’¡ ì´ ë•Œ ë³´ì´ëŠ” íŒ¨í‚¤ì§€ë“¤ì€ ì•„ì§ ì„¤ì¹˜ê°€ ì•ˆëœ íŒ¨í‚¤ì§€ë“¤. (TODO ë””ìŠ¤í¬ë¥¼ ì–´ë–»ê²Œ ì‚¬ìš©í•˜ëŠ”ì§€ ê³µë¶€í•´ë³´ì)

2.1. ë§Œì•½ ì›í•˜ëŠ” ë²„ì „ì´ ì—†ë‹¤ë©´ PostgreSQL ê³µì‹ ì €ì¥ì†Œ ì¶”ê°€
```
yum install https://download.postgresql.org/pub/repos/yum/reporpms/EL-7-x86_64/pgdg-redhat-repo-latest.noarch.rpm
```

3. postgresql ì„¤ì¹˜ (13ë²„ì „ ê¸°ì¤€)
```
yum install postgresql13-server postgresql13-contrib
```

4. ë§Œì•½ DBì €ì¥ì†Œ ë°”ê¾¸ê³  ì‹¶ë‹¤ë©´ ì„œë¹„ìŠ¤ íŒŒì¼ ë³€ê²½
```
vi /usr/lib/systemd/system/postgresql-13.service

Environment=PGDATA=/path/data #ì°¸ê³ ë¡œ ì´ data í´ë”ëŠ” postgres ì ‘ê·¼ê¶Œí•œ ìˆì–´ì•¼í•¨.
```

5. DB ì´ˆê¸°í™”
```
/usr/pgsql-13/bin/postgresql-13-setup initdb
```

6. postgresql ì„œë¹„ìŠ¤ ì‹œì‘ ë° ì¬ë¶€íŒ…í–ˆì„ ë•Œ PostgreSQL DB ìë™ ì‹¤í–‰ í™œì„±í™”
```
systemctl start postgresql-13
systemctl enable postgresql-13
```

7. postgres ì»¤ë„ ì ‘ì†
```
> psql
```

8. DB ì»¤ë„ ì ‘ì†í•´ì„œ postgres íŒ¨ìŠ¤ì›Œë“œ ë§Œë“¤ê¸°
```
\password postgres
```

9. ë‹¤ë¥¸ ê³„ì •ìœ¼ë¡œ ì ‘ì†ì‹œì—ëŠ” ì•„ë˜ì™€ ê°™ì´ ì ‘ì†(.bashrc íŒŒì¼ì— ì•„ë˜ ëª…ë ¹ì–´ ë„£ì–´ë†“ìœ¼ë©´ í•´ë‹¹ ê³„ì • ì ‘ì†ì‹œ ë°”ë¡œ DBë¡œ ì´ë™ë˜ë„ë¡ ì‚¬ìš©ê°€ëŠ¥)
```
psql -h localhost -U postgres -d mydatabase
```

ğŸ’¡ íŒ¨ìŠ¤ì›Œë“œ ìë™í™” ì‚¬ìš©ì‹œ
.pgpass íŒŒì¼ì„ ë§Œë“¤ì–´ì„œ ì•„ë˜ì™€ ê°™ì´ ì…ë ¥í•œë‹¤. ë‹¨, .pgpassíŒŒì¼ì€ í•´ë‹¹ ê³„ì • ì†Œìœ ê¶Œí•œìœ¼ë¡œ ë§Œë“¤ì–´ì•¼í•¨(root X)
```
localhost:5432:mydatabase:postgres:konan415
```

# ì™¸ë¶€ ì ‘ì† í—ˆìš©
1. sudo vi /etc/postgresql/12/main/postgresql.conf ìˆ˜ì •
```
#listen_addresses = 'localhost'  => listen_addresses = '*' 
```
     
2. sudo vi /etc/postgresql/12/main/pg_hba.conf ì— ì•„ë˜ í•­ëª© ì¶”ê°€
```
host    all   all  0.0.0.0/0   md5
```