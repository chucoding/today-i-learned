# Postgres
대표적인 NoSQL기반 무료 데이터베이스

# 설치방법
centos에서 포스트그레 설치 방법
(TODO 12, 13등 버전별로 달라지므로 수정 필요)

1. 설치된 패키지가 있는지 확인(이미 설치되어있는데 다시 설치하는것을 방지)
```
yum list installed | grep postgresql
```

2. 설치 가능한 postgresql 패키지 버전 확인 (패키지 버전 확인 안하고 바로 yum install 하면 postgresql 최신 버전 설치가 안될 수 있다.)
```shell 
yum list postgresql*
```
💡 이 때 보이는 패키지들은 아직 설치가 안된 패키지들. (TODO 디스크를 어떻게 사용하는지 공부해보자)

2.1. 만약 원하는 버전이 없다면 PostgreSQL 공식 저장소 추가
```
yum install https://download.postgresql.org/pub/repos/yum/reporpms/EL-7-x86_64/pgdg-redhat-repo-latest.noarch.rpm
```

3. postgresql 설치 (13버전 기준)
```
 yum install postgresql13-server postgresql13-contrib
 ```

4. DB 초기화
```
/usr/pgsql-13/bin/postgresql-13-setup initdb
```
💡 DB초기화를 먼저해줘야 나중에 마운트 경로를 바꾸더라도 오류가 없다.

5. 만약 DB저장소 바꾸고 싶다면 서비스 파일 변경
 ```
vi /usr/lib/systemd/system/postgresql-13.service

Environment=PGDATA=/path
```

6. DB 저장소 변경했다면 설치시 새로 만들어진 /var/lib/pgsql 폴더를 원하는 경로에 복사(postgres 계정이 만들어지는데 이걸 이동시켜야함)

```
su - root
cd /var/lib/pgsql /path
```

7. 변경된 설정 재시작
```
systemctl restart postgresql-13
```

8. 재부팅했을 때 PostgreSQL DB 자동 실행 활성화
```
systemctl enable postgresql-13
```

9. 필요에 따라 postgres ssh 패스워드 만들기. 그 외에는 아래와 같이 접속
```
sudo -u postgres psql

\password postgres
```